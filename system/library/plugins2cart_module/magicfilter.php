<?php
/*
  Module Name: Magic Filter
  Description:MagicFilter plugin is one of the best product filter plugin for opencart. It has feature to filter products by
  manufactures and price range.
  Author: Rootingenious infotch
  Author Email:support@rootingenious.com
  Author URI: www.rootingenious.com
  Version: 2.3.0
  Tags: filter, magic filter, price filter, manufacture filter, brand filter,product filter
 */
 class Magicfilter { private $db; private $config; private $cache; private $registry; private $url; private $currency; private $session; private $data = array(); public function __construct($registry) { goto MR2zt; MR2zt: $this->db = $registry->get("\x64\x62"); goto Mk5z8; ZKRZD: $this->session = $registry->get("\x73\x65\163\x73\x69\x6f\x6e"); goto ysCl5; Mk5z8: $this->config = $registry->get("\143\x6f\x6e\x66\x69\x67"); goto exkCG; it2Ri: $this->url = $registry->get("\165\162\x6c"); goto ZKRZD; exkCG: $this->cache = $registry->get("\x63\141\143\x68\145"); goto QBMZ4; QBMZ4: $this->registry = $registry; goto it2Ri; ysCl5: $this->currency = $registry->get("\x63\x75\x72\x72\x65\x6e\143\171"); goto syA5p; syA5p: } public function getmanufacture_by_catagory_id_info($data) { goto lEPhw; UDdVH: if (isset($dataim) && $dataim !== '') { goto ADVng; } goto YXUR5; COkfD: ADVng: goto JQJJ3; MfgaT: $query = $this->db->query($sql); goto g_J4x; g_J4x: $manufacturer_data = $query->rows; goto fwtiN; Aj4Zn: RBvHw: goto UDdVH; YXUR5: return array(); goto zLEdU; vrhxt: GxqhW: goto uqLBK; zLEdU: goto GxqhW; goto COkfD; lEPhw: foreach ($data as $key => $value) { goto YWpoE; g296z: U5fmD: goto Sc2QC; rhvzu: $dataim = $data[0]; goto g296z; YWpoE: $value = trim($value); goto GQxTq; GQxTq: if (empty($value)) { goto I6AMY; } goto IU73N; Sc2QC: Jnlqv: goto iwGb6; mPlDJ: goto U5fmD; goto PSLy7; PSLy7: I6AMY: goto rhvzu; IU73N: $dataim = implode("\54", $data); goto mPlDJ; iwGb6: } goto Aj4Zn; fwtiN: return $manufacturer_data; goto vrhxt; JQJJ3: $sql = "\123\105\114\x45\103\124\x20\52\40\106\122\117\x4d\x20" . DB_PREFIX . "\x6d\141\156\x75\x66\141\143\x74\165\x72\145\162\x20\x20\x57\110\105\122\x45\40\x6d\141\156\165\x66\141\x63\164\x75\162\x65\x72\x5f\151\x64\x20\x69\156\x20\x28{$dataim}\51"; goto MfgaT; uqLBK: } public function filter_data_info($request, $config) { goto Ogs8V; fwiJT: $data["\160\162\x6f\x64\x75\143\164\137\143\x6c\x61\x73\x73"] = $config->get("\x6d\141\x67\151\143\x66\x69\x6c\164\x65\162\x5f\x70\162\x69\x63\x65\x5f\x66\151\154\164\145\162\137\143\x6c\x61\x73\163"); goto KoRYv; Rzh9I: $data["\x6d\x61\x67\151\x63\x66\x69\x6c\x74\145\x72\137\151\x6d\141\147\145\x5f\163\164\141\164\x75\x73"] = 0; goto jpz3Q; TF7Pk: $pcode = $this->session->data["\143\165\162\x72\x65\x6e\x63\171"]; goto FRo7k; ZI_m7: MRxk6: goto xmvcz; L5xDH: if (isset($request->get["\x70\162\151\x63\x65\137\162\141\x6e\x67\x65"])) { goto lYC9S; } goto Ya0ib; bdOj2: $data["\x72\x69\147\x68\x74\137\x63\x6f\144\x65"] = true; goto RJf0g; CiWqk: qB8d7: goto U1zVR; dI7pD: if ($config->get("\x6d\x61\147\x69\x63\x66\151\154\164\145\x72\137\x68\145\x61\x64\151\156\147") != '') { goto zYgm7; } goto gCEli; kiSFE: $data["\155\141\147\151\x63\146\x69\154\x74\145\x72\137\151\x6d\141\147\145\137\150\145\x69\x67\150\x74"] = $config->get("\155\141\x67\x69\x63\146\x69\154\x74\x65\162\137\x69\x6d\141\x67\145\137\150\x65\151\x67\150\x74"); goto jQ3k7; Gp0aM: k5o9J: goto x79kw; cWfPs: HxWVO: goto RUXbs; GV7i3: zN_hf: goto zR2Vy; wPnEu: $data["\x6d\x61\x67\x69\x63\x66\151\x6c\164\145\162\x5f\x70\162\x69\143\145\x5f\x66\151\154\164\x65\x72\x5f\x73\164\x61\x74\165\163"] = $config->get("\x6d\x61\147\151\x63\x66\x69\x6c\164\x65\x72\137\x70\162\x69\x63\145\x5f\x66\151\x6c\x74\x65\x72\137\163\164\x61\x74\165\163"); goto RfjOI; lauFI: j6vCn: goto dI7pD; RfjOI: YGXme: goto blMpq; IYzfl: if ($config->get("\x6d\x61\147\151\143\146\x69\154\164\145\162\x5f\151\155\141\x67\x65\x5f\167\151\144\164\150") != '') { goto hVZnM; } goto la5Eu; bwtr0: foreach ($magicfilter as $manufacturer) { goto RkGDz; vvLYg: fWXJj: goto kaf_1; orq8d: $data["\155\x61\x6e\165\146\141\x63\164\165\x72\145\162\x73"][] = array("\155\x61\156\165\x66\x61\143\x74\165\x72\145\162\137\151\144" => $manufacturer["\x6d\x61\x6e\165\x66\141\x63\164\x75\x72\x65\162\x5f\x69\x64"], "\x6e\x61\155\145" => $manufacturer["\x6e\x61\155\145"], "\151\x6d\141\x67\x65" => $manufacturer["\x69\x6d\x61\147\145"] ? "\x69\155\x61\x67\x65\57" . $manufacturer["\151\x6d\x61\x67\145"] : "\x69\x6d\141\x67\x65\57\156\157\137\151\x6d\141\147\145\56\x70\x6e\x67", "\x68\x72\x65\146" => $this->url->link("\160\162\157\144\x75\x63\164\x2f\155\141\156\x75\x66\x61\143\164\x75\162\x65\162\x2f\x69\156\x66\x6f", "\155\x61\x6e\x75\146\x61\143\x74\165\x72\145\162\137\x69\144\75" . $manufacturer["\155\141\x6e\x75\146\x61\x63\164\165\162\145\x72\x5f\x69\x64"])); goto vvLYg; RkGDz: $filter_data1 = array("\146\x69\154\164\145\162\x5f\155\x61\156\x75\x66\x61\143\164\165\162\x65\x72\137\x69\x64" => $manufacturer["\155\141\x6e\165\x66\x61\143\164\165\x72\x65\162\137\x69\144"]); goto orq8d; kaf_1: } goto fSybr; P40fW: zYgm7: goto hGdBv; uddmC: eLf8B: goto kiSFE; vkxzR: $data["\x70\162\x69\143\x65\x5f\x72\x61\x6e\147\145\137\x6d\x61\x78"] = $this->currency->convert($range[1], "\x58\x59\x5a", $pcode); goto fwiJT; cPnJt: $magicfilter = array(); goto iyaa1; WNyK0: lYC9S: goto qLenS; Kvq5g: goto Ra4Eb; goto AqN3U; Sowg2: $sort = $request->get["\x73\x6f\x72\x74"]; goto CBMjN; pPxAH: eY4oS: goto L5xVO; RJf0g: goto ipe_K; goto OFpQp; pIVlR: $data["\155\141\x67\151\143\x66\151\154\x74\145\x72\137\151\x6d\x61\x67\145\x5f\167\x69\x64\x74\150"] = $config->get("\x6d\141\x67\x69\x63\x66\x69\154\164\x65\162\x5f\x69\x6d\x61\x67\x65\137\167\x69\x64\164\x68"); goto K0ySI; C_l5F: $data["\155\x61\x67\151\x63\x66\x69\154\164\x65\x72\137\151\155\141\147\145\x5f\150\145\151\147\150\164"] = 30; goto CO5CC; ByrEo: goto fokqH; goto vDAcX; Reann: LnZr1: goto IYzfl; Bez6Z: $path = ''; goto orvzN; NKMWI: $range = explode("\x2d", "\60\55\60"); goto l9OFm; g1R2n: vBpjh: goto Sowg2; IkTqe: goto Ty5MP; goto ZI_m7; x79kw: if ($this->currency->getSymbolLeft($pcode)) { goto Gf6AF; } goto UT5L1; olEt2: $data["\x70\162\x69\143\x65\x5f\162\x61\x6e\x67\x65\137\155\x69\156"] = $this->currency->convert($range[0], "\x58\131\132", $pcode); goto vkxzR; CO5CC: goto g20xx; goto uddmC; AGGqR: $results = $pmodel->getProducts($filter_data); goto fmbci; WmDpJ: SkkgV: goto Ri5yZ; bVRhT: $mdl = $this->registry->get("\x6d\x6f\x64\x65\154\x5f\x63\x61\x74\141\154\157\x67\137\143\141\164\145\x67\x6f\x72\x79"); goto eoqc6; ynBo9: goto XszDT; goto cWfPs; EknUQ: $filter = $request->get["\x66\151\x6c\x74\145\x72"]; goto JwPFz; KoRYv: return $data; goto fjJNE; oJOO3: dSpeX: goto bVRhT; ZqFSR: $data["\160\162\x6f\144\x75\143\x74\137\155\x61\x6e\x5f\x6c\151\x73\164"] = $product_man_list_final; goto PsJDJ; K0ySI: fokqH: goto oPL3S; qLenS: $data["\160\162\151\x63\145\x5f\162\141\x6e\147\145"] = explode("\x2d", $request->get["\x70\162\151\x63\x65\137\162\141\x6e\x67\x65"]); goto QHpWu; uNZz9: $filter = ''; goto Kvq5g; Adnvw: if (!isset($magicfilter)) { goto v3vFP; } goto bwtr0; DDyTs: $pmodel = $this->registry->get("\x6d\157\x64\x65\x6c\137\x63\141\x74\141\154\x6f\147\137\160\x72\x6f\144\165\143\164"); goto MR8jd; jpz3Q: goto LnZr1; goto uZ3wA; tNJL7: kXrm0: goto a2tEc; zR2Vy: if (isset($request->get["\x6c\151\x6d\151\x74"])) { goto HxWVO; } goto j_dNK; yFwQU: if (version_compare(VERSION, "\x32\56\62\x2e\x30\56\60", "\74") == true) { goto q_COe; } goto TF7Pk; a2tEc: TJ2b2: goto ZqFSR; Ya0ib: $data["\x70\x72\x69\143\x65\137\162\141\x6e\x67\145"] = array(); goto bU6M0; OFpQp: Gf6AF: goto gz0F1; FRo7k: goto k5o9J; goto QZ5pl; zEpk_: if (isset($request->get["\163\x6f\x72\x74"])) { goto vBpjh; } goto LX2zi; RUXbs: $limit = (int) $request->get["\x6c\x69\155\151\164"]; goto YMwGn; pp__V: foreach ($results as $product) { goto lCLEw; QO_Kb: fCiby: goto xWRW6; Z2GTh: $product_man_list[$product["\155\141\x6e\x75\x66\x61\x63\164\165\x72\145\x72\137\x69\x64"]][] = $product["\160\x72\157\144\165\x63\x74\x5f\151\144"]; goto QO_Kb; lCLEw: $manufacture[] = $product["\155\x61\x6e\165\x66\141\x63\164\x75\162\145\162\137\x69\x64"]; goto Z2GTh; xWRW6: } goto lHe8W; rDGso: $pcode = $this->currency->getCode(); goto Gp0aM; nHxhR: $filter_data = array("\146\151\x6c\x74\145\162\x5f\143\x61\164\x65\147\157\162\x79\x5f\151\144" => $category_id, "\146\x69\154\164\x65\162\137\x66\x69\154\x74\145\162" => $filter, "\163\157\162\x74" => $sort, "\x6f\162\144\145\162" => $order, "\163\x74\141\x72\x74" => ($page - 1) * $limit, "\x6c\x69\155\151\x74" => $limit); goto DDyTs; C8gOB: $order = "\101\123\103"; goto IkTqe; RKln8: $parts = $request->get["\x70\141\x74\150"]; goto irebb; fkm4Q: if (isset($request->get["\157\162\x64\145\x72"])) { goto MRxk6; } goto C8gOB; mpOpO: goto D8hYy; goto wMIi4; UT5L1: $code = $this->currency->getSymbolRight($pcode); goto bdOj2; Yuz43: $data["\x70\x72\151\143\145\x5f\143\157\x64\x65"] = $code; goto B5A18; qtB26: goto dSpeX; goto j0MO5; QHpWu: VsZaW: goto yFwQU; BQF08: $magic = $this->registry->get("\155\x6f\144\x65\154\x5f\x65\x78\x74\x65\156\x73\151\157\x6e\x5f\x6d\157\144\x75\x6c\x65\137\x6d\x61\147\151\143\x66\151\154\x74\145\x72"); goto GzHcT; AW8a5: $category_id = (int) array_pop($parts); goto qtB26; L5xVO: $page = $request->get["\160\141\147\145"]; goto GV7i3; LX2zi: $sort = "\160\x2e\x73\157\x72\x74\137\x6f\x72\x64\145\162"; goto McPzP; MR8jd: $product_total = $pmodel->getTotalProducts($filter_data); goto AGGqR; CBMjN: WWlQZ: goto fkm4Q; Ri5yZ: if ($config->get("\155\x61\x67\x69\143\x66\151\154\x74\x65\x72\x5f\x69\x6d\141\x67\x65\137\163\x74\141\x74\x75\x73") != '') { goto nlaDW; } goto Rzh9I; JTN9L: $data["\155\141\x6e\x75\146\141\143\x74\x75\x72\145\x72\x5f\x73\164\x61\164\165\x73"] = $config->get("\x6d\141\x67\151\143\146\x69\x6c\164\x65\x72\137\155\141\156\x75\x66\x61\x63\x74\x75\162\x65\162\137\x66\x69\x6c\x74\x65\x72\137\163\164\x61\164\165\x73"); goto FQpNf; pQMZo: if (!(isset($manufacture) && count($manufacture) > 0)) { goto iVvee; } goto BQF08; hqPnD: $category_id = ''; goto AW8a5; WFhxB: goto SkkgV; goto P40fW; McPzP: goto WWlQZ; goto g1R2n; Ogs8V: if (isset($request->get["\146\x69\x6c\x74\x65\162"])) { goto IW0Fh; } goto uNZz9; eoqc6: $category_info = $mdl->getCategory($category_id); goto nHxhR; la5Eu: $data["\155\141\x67\151\143\x66\151\154\164\145\x72\137\151\155\141\147\x65\137\167\151\144\164\150"] = 30; goto ByrEo; ju1x9: if (!isset($request->get["\x70\141\x74\150"])) { goto qB8d7; } goto nuFP2; fSybr: EVTLP: goto L5xDH; orvzN: $parts = explode("\137", (string) $request->get["\x70\141\164\x68"]); goto hqPnD; NT1XL: if (isset($request->get["\x70\x61\147\x65"])) { goto eY4oS; } goto tzLdi; iyaa1: QIYZJ: goto Adnvw; SWkJs: foreach ($product_man_list as $key => $value) { $product_man_list_final[$key] = implode("\137", $value); gmcWz: } goto tNJL7; YMwGn: XszDT: goto ju1x9; h5V9t: $product_man_list_final = array(); goto pp__V; hGdBv: $data["\155\141\147\151\143\146\151\x6c\164\145\x72\x5f\x68\145\141\x64\x69\x6e\x67"] = $config->get("\155\x61\147\151\143\x66\151\154\164\x65\162\137\150\145\x61\144\151\x6e\147"); goto WmDpJ; oPL3S: if ($config->get("\x6d\x61\147\151\143\146\x69\x6c\x74\145\x72\137\x69\155\x61\x67\145\137\150\145\x69\x67\150\x74") != '') { goto eLf8B; } goto C_l5F; gz0F1: $code = $this->currency->getSymbolLeft($pcode); goto piXHV; B5A18: if (!$config->get("\x6d\141\x67\x69\x63\x66\151\154\164\x65\x72\137\160\x72\151\x63\x65\137\x66\151\154\x74\x65\x72\137\x72\141\x6e\x67\145")) { goto UOk6b; } goto qcnyJ; jQ3k7: g20xx: goto JTN9L; j_dNK: $limit = $config->get($config->get("\143\x6f\x6e\x66\151\147\137\x74\150\145\x6d\x65") . "\x5f\160\162\x6f\144\165\143\x74\x5f\x6c\x69\x6d\x69\x74"); goto ynBo9; AqN3U: IW0Fh: goto EknUQ; lHe8W: VDURz: goto pQMZo; Yd_R5: $data["\x6d\141\x67\x69\143\146\151\154\164\145\162\137\x6d\x61\156\x75\x66\x61\x63\164\x75\162\x65\x72\x5f\x66\151\x6c\x74\145\x72\137\163\164\141\x74\x75\x73"] = $config->get("\x6d\x61\x67\151\x63\146\x69\154\x74\x65\162\x5f\x6d\141\x6e\165\146\141\143\164\x75\162\145\x72\x5f\146\x69\154\164\145\x72\x5f\x73\164\141\164\165\x73"); goto lauFI; FQpNf: $data["\160\x72\x69\143\145\137\x66\x69\x6c\164\145\x72\x5f\163\x74\141\x74\x75\x73"] = $config->get("\155\141\147\151\x63\x66\151\154\x74\x65\x72\137\160\162\151\143\145\137\x66\151\x6c\x74\x65\162\x5f\x73\164\x61\164\x75\163"); goto d9LmN; xmvcz: $order = $request->get["\157\162\x64\145\x72"]; goto NNCV2; Z9Z6F: ipe_K: goto Yuz43; mSiRU: $data["\155\x61\x67\151\143\x66\x69\x6c\164\145\162\x5f\x69\x6d\141\147\145\x5f\x73\x74\141\164\165\163"] = $config->get("\x6d\141\x67\x69\143\146\151\154\164\x65\162\x5f\x69\155\x61\x67\145\x5f\x73\164\x61\x74\165\163"); goto Reann; Og0FG: iVvee: goto dZ3dH; dZ3dH: if (!(isset($product_man_list) && count($product_man_list) > 0)) { goto TJ2b2; } goto SWkJs; JwPFz: Ra4Eb: goto zEpk_; PsJDJ: if (!($config->get("\x6d\x61\147\x69\143\146\x69\x6c\164\x65\x72\x5f\x70\162\151\x63\x65\x5f\146\x69\154\164\145\x72\x5f\x73\164\x61\164\165\x73") != '')) { goto YGXme; } goto wPnEu; fmbci: $product_man_list = array(); goto h5V9t; j0MO5: m_QKS: goto RKln8; Cdr7o: goto zN_hf; goto pPxAH; uZ3wA: nlaDW: goto mSiRU; tzLdi: $page = 1; goto Cdr7o; blMpq: if (!($config->get("\x6d\141\x67\x69\143\146\x69\154\164\145\162\137\155\x61\x6e\x75\x66\141\x63\x74\x75\x72\145\x72\137\146\x69\x6c\164\x65\162\137\163\164\141\164\165\x73") != '')) { goto j6vCn; } goto Yd_R5; NNCV2: Ty5MP: goto NT1XL; gCEli: $data["\155\141\147\x69\x63\x66\x69\154\x74\x65\162\x5f\150\x65\x61\x64\x69\156\x67"] = "\x6d\141\x67\151\x63\x66\151\154\164\145\x72"; goto WFhxB; d9LmN: if (isset($magicfilter)) { goto QIYZJ; } goto cPnJt; wMIi4: UOk6b: goto NKMWI; nuFP2: if (stristr($request->get["\x70\x61\164\x68"], "\137") === FALSE) { goto m_QKS; } goto Bez6Z; QZ5pl: q_COe: goto rDGso; fjJNE: v3vFP: goto CiWqk; irebb: $category_id = $request->get["\160\x61\164\x68"]; goto oJOO3; bU6M0: goto VsZaW; goto WNyK0; l9OFm: D8hYy: goto olEt2; qcnyJ: $range = explode("\x2d", $config->get("\x6d\x61\x67\151\143\146\151\154\164\145\x72\137\x70\x72\x69\x63\x65\137\x66\151\154\164\x65\162\137\x72\x61\156\x67\145")); goto mpOpO; piXHV: $data["\162\151\x67\150\x74\137\x63\157\144\x65"] = false; goto Z9Z6F; GzHcT: $magicfilter = $magic->getmanufacture_by_catagory_id($manufacture); goto Og0FG; vDAcX: hVZnM: goto pIVlR; U1zVR: } }
